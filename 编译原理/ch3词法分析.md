

token：int（for pc）或字符串（好读）



预处理：例如多个空格转为一个空格



如果规定长度为256，这指示器为256*2，例如如果从中间开始，就可以装下（循环扫描清空进入）



P18：2和3状态可以合并吗



只要是能到终态的都是语句

# 3.1 概述

编译程序首先是在单词级别上来分析和翻译源程序的。 

词法分析的任务是：从左至右逐个字符地对源程序进行扫 描，产生一个个单词符号，把作为**字符串**的源程序改造成为单**词符号串**的中间程序。 

词法分析是编译的基础。执行词法分析的程序称为词法分 析器。



# 3.2 词法分析器

源程序——》扫描器——》输出单词符号（关键字、标识符、常数、运算符）

## 单词符号

单词符号的属性是指单词符号的特征或特性。属 性值则是反映特性或特征的值。

(单词种别, 单词符号的属性值) 

- 标识符的属性值是存放它符号表项的指针或内部字符 串； 
- 常数的属性值是存放它的常数表项的指针或二进制形 式； 
- 关键字、运算符和界符是一符一种，不需给出其自身 的值。

![image-20210929223617229](ch3词法分析.assets/image-20210929223617229.png)



## 词法分析程序的实现方式

◼ 完全独立方式：词法分析程序作为单独一遍来实 现。词法分析程序读入整个源程序，它的输出作 为语法分析程序的输入。

 编译程序结构简洁、清晰和条理化 

◼ 相对独立方式：把词法分析程序作为语法分析程 序的一个独立子程序。语法分析程序需要新符号 时调用这个子程序。

 优点：避免了中间文件生成，可以提高效率。



## 词法分析器的结构

![image-20210929225133598](ch3词法分析.assets/image-20210929225133598.png)

## 状态转换图



![image-20210930085146690](ch3词法分析.assets/image-20210930085146690.png)

可接受符号串，如果有一条路能产生这个符号串，就称为可以识别

路:在状态转换图中从初始状态到某一终止状态的 弧上的标记序列。

![image-20210930085549399](ch3词法分析.assets/image-20210930085549399.png)





## 举例

![image-20210930085211357](ch3词法分析.assets/image-20210930085211357.png)

![image-20210930090050991](ch3词法分析.assets/image-20210930090050991.png)



## 例题

21-22



# 3.3 正规表达式与有限自动机

字母表 ∑ 上的正规式和正规集递归定义如下： 

- ε 和 φ 都是 ∑ 上的正规式，它们所表示的正规集分别 为{ε}和 φ。其中：ε为空字符串，φ为空集； 

- 任意元素a∈∑，a是∑上的一个正规式，它所表示的 正规集是{a}; 

- 假定U和V都是∑上的正规式，它们所表示的正规集 记为L(U)和L(V)，那么（U|V），（U·V）和(U)* 都是正规式，他们所表示的正规集分别记为L(U)∪L(V)， L(U)L(V) 和 (L(U))* 。 

- 仅由有限次使用上述三步而得到的表达式才是 ∑ 上的 正规式，它们所表示的字集才是 ∑ 上的正规集。

![image-20210930101456859](ch3词法分析.assets/image-20210930101456859.png)

分析例子：

![image-20210930101818624](ch3词法分析.assets/image-20210930101818624.png)

## 一些运算

![image-20210930092415554](ch3词法分析.assets/image-20210930092415554.png)

 ”|”读为”或”；

”.”读为”连接” ，可省略不写

”*”读为”闭包”

的优先顺序为：”*”最高, ”.”次之, ”|” 最低。 

若两个正规式所表示的正规集相同，则认为二者等价，记 为U=V。









# 3.4 自动机

是自动机？

具有离散输入输出的数学模型。 

自动机接受一定的输入，执行一定的动作，产生一定的结果。使用状态 迁移描述整个工作过程。

本质：

根据状态、输入和规则决定下一个状态 ；

状态 ＋ 输入＋ 规则 ―> 状态迁移；



# FA与DFA

有限自动机（FA，Finite Automata）

一个机器或一种控制结构，设计它的目的是为 了自动仿效一个事先确定的操作序列或响应一 条已编码的指令。

确定有限自动机（DFA）

![image-20210930103554989](ch3词法分析.assets/image-20210930103554989.png)









# 状态消去法

## 原则

![image-20210930103809088](ch3词法分析.assets/image-20210930103809088.png)

## 例子

![image-20210930103924944](ch3词法分析.assets/image-20210930103924944.png)



![image-20210930104059383](ch3词法分析.assets/image-20210930104059383.png)

（a|b）* abb

1-6 正闭包



# Thompson算法

![image-20210930104224214](ch3词法分析.assets/image-20210930104224214.png)

a为任意字符

![image-20210930104301090](ch3词法分析.assets/image-20210930104301090.png)



3，反向指的是闭包

框框指的是原有的状态图



## 例子

![image-20210930104513489](ch3词法分析.assets/image-20210930104513489.png)

![image-20210930104533773](ch3词法分析.assets/image-20210930104533773.png)

# DFA的化简

步骤

![image-20210930105534407](ch3词法分析.assets/image-20210930105534407-16335090570221.png)





## 例题

![image-20210930110413243](ch3词法分析.assets/image-20210930110413243-16335090585442.png)

3456和012是可区分的，

考察那一行是考虑例如3接受a到3,6接受a在3

3456接受a在3663，只在一个子集中。

45也只落在一个子集上

所以a和b没办法区分I1——由于接受符号迁移到同一个子集，如果迁移到不同子集就可以找到特例，就可以把I1拆分，如果接受a区分，那么就是a和epl可以区分

可区分：找到一个符号串，一部分接受这个符号串可以到zhongtai，另一部分到不了。



# 正规文法和有限自动机的转化

## 文法到自动机

![image-20210930111535548](ch3词法分析.assets/image-20210930111535548-16335090604573.png)

A是起始状态，0到f，或0到B，或1到D

## 自动机到文法

![image-20210930111625549](ch3词法分析.assets/image-20210930111625549-16335090622384.png)

A：0（0到B直接终结）| 0B | 1D

做线性：从终点到起点



![image-20210930112041916](ch3词法分析.assets/image-20210930112041916-16335090644505.png)

如果E只有吸收状态，不出去就可以D定义为bE，但E有出口，所以D定义为bE







每个表达式都转换成NFA，n个规则n个NFA





